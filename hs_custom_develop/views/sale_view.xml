<?xml version='1.0' encoding='utf-8'?>
<odoo>
	<data>
		
		<record id="stri_custom_sale_view" model="ir.ui.view">
			<field name="name">stri.custom.sale.view</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_form"/>
			<field name="arch" type="xml">

				<xpath expr="//field[@name='expected_date']" position="after">
					<field name="required_invoice" required="True" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
				</xpath>
			</field>
		</record>


		<record id="sale_order_delivery_inherit_form" model="ir.ui.view">
			<field name="name">sale.order.delivery.inherit.form</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale_stock.view_order_form_inherit_sale_stock"/>
			<field name="arch" type="xml">
				
				<xpath expr="//div[@name='button_box']" position="after">
					<field name="required_invoice" invisible="1"/>
				</xpath>

				<xpath expr="//button[@name='action_view_delivery']" position="attributes">
					<attribute name="attrs">
						{'invisible': ['|', '&amp;', ('delivery_count', '=', 0), ('required_invoice', '=', True), ('invoice_status', '!=', 'invoiced')]}
					</attribute>
				</xpath>

			</field>
		</record>
	</data>
</odoo>